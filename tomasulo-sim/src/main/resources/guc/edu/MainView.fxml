<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="guc.edu.sim.ui.MainController"
            prefWidth="1400.0" prefHeight="900.0"
            minWidth="1100.0" minHeight="700.0"
            style="-fx-background-color: #f5f5f5;">

    <!-- Top: Enhanced menu + toolbar with status -->
    <top>
        <VBox style="-fx-background-color: white; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 4, 0, 0, 2);">
            <MenuBar style="-fx-background-color: white;">
                <menus>
                    <Menu text="File">
                        <items>
                            <MenuItem text="New Program" onAction="#onNewProgram"/>
                            <MenuItem text="Open Program..." onAction="#onOpenProgram"/>
                            <MenuItem text="Save Program..." onAction="#onSaveProgram"/>
                            <SeparatorMenuItem/>
                            <MenuItem text="Load Configuration..." onAction="#onLoadConfig"/>
                            <MenuItem text="Save Configuration..." onAction="#onSaveConfig"/>
                            <SeparatorMenuItem/>
                            <MenuItem text="Exit" onAction="#onExit"/>
                        </items>
                    </Menu>
                    <Menu text="Simulation">
                        <items>
                            <MenuItem text="Run" onAction="#onRun"/>
                            <MenuItem text="Pause" onAction="#onPause"/>
                            <MenuItem text="Step" onAction="#onStep"/>
                            <MenuItem text="Reset" onAction="#onReset"/>
                            <SeparatorMenuItem/>
                            <MenuItem text="Configuration..." onAction="#onShowConfig"/>
                        </items>
                    </Menu>
                    <Menu text="View">
                        <items>
                            <CheckMenuItem text="Show Log Panel" selected="true" fx:id="showLogMenuItem"/>
                            <CheckMenuItem text="Show Statistics" selected="true" fx:id="showStatsMenuItem"/>
                            <SeparatorMenuItem/>
                            <MenuItem text="Expand All Sections" onAction="#onExpandAll"/>
                            <MenuItem text="Collapse All Sections" onAction="#onCollapseAll"/>
                        </items>
                    </Menu>
                    <Menu text="Help">
                        <items>
                            <MenuItem text="About Tomasulo Algorithm" onAction="#onAbout"/>
                            <MenuItem text="User Guide" onAction="#onHelp"/>
                        </items>
                    </Menu>
                </menus>
            </MenuBar>

            <ToolBar style="-fx-background-color: #fafafa; -fx-padding: 8;">
                <HBox spacing="5" alignment="CENTER_LEFT">
                    <Button text="â–¶ Run" onAction="#onRun" 
                            style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 6 16; -fx-background-radius: 4;"/>
                    <Button text="â¸ Pause" onAction="#onPause"
                            style="-fx-background-color: #FF9800; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 6 16; -fx-background-radius: 4;"/>
                    <Button text="â­ Step" onAction="#onStep"
                            style="-fx-background-color: #2196F3; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 6 16; -fx-background-radius: 4;"/>
                    <Button text="âŸ² Reset" onAction="#onReset"
                            style="-fx-background-color: #f44336; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 6 16; -fx-background-radius: 4;"/>
                </HBox>
                
                <Separator orientation="VERTICAL"/>
                
                <HBox spacing="5" alignment="CENTER_LEFT">
                    <Button text="ðŸ“„ New" onAction="#onNewProgram"
                            style="-fx-background-color: white; -fx-border-color: #ddd; -fx-border-radius: 4; -fx-background-radius: 4; -fx-padding: 6 12;"/>
                    <Button text="ðŸ“‚ Open" onAction="#onOpenProgram"
                            style="-fx-background-color: white; -fx-border-color: #ddd; -fx-border-radius: 4; -fx-background-radius: 4; -fx-padding: 6 12;"/>
                    <Button text="âš™ Config" onAction="#onShowConfig"
                            style="-fx-background-color: white; -fx-border-color: #ddd; -fx-border-radius: 4; -fx-background-radius: 4; -fx-padding: 6 12;"/>
                </HBox>
                
                <Region HBox.hgrow="ALWAYS"/>
                
                <!-- Status indicators -->
                <HBox spacing="20" alignment="CENTER_RIGHT">
                    <VBox spacing="2" alignment="CENTER">
                        <Label text="Cycle" style="-fx-font-size: 10; -fx-text-fill: #666;"/>
                        <Label fx:id="cycleLabel" text="0" 
                               style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: #2196F3;"/>
                    </VBox>
                    
                    <Separator orientation="VERTICAL"/>
                    
                    <VBox spacing="2" alignment="CENTER">
                        <Label text="Instructions" style="-fx-font-size: 10; -fx-text-fill: #666;"/>
                        <Label fx:id="instrCountLabel" text="0 / 0"
                               style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #4CAF50;"/>
                    </VBox>
                    
                    <VBox spacing="2" alignment="CENTER">
                        <Label text="Status" style="-fx-font-size: 10; -fx-text-fill: #666;"/>
                        <Label fx:id="statusLabel" text="Ready"
                               style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #666;"/>
                    </VBox>
                </HBox>
            </ToolBar>
        </VBox>
    </top>

    <!-- Center: Tabbed interface for better organization -->
    <center>
        <TabPane tabClosingPolicy="UNAVAILABLE" style="-fx-background-color: #f5f5f5;">
            
            <!-- Program Tab -->
            <Tab text="ðŸ“‹ Program Execution">
                <BorderPane style="-fx-background-color: #f5f5f5;">
                    <padding>
                        <Insets top="10" right="10" bottom="10" left="10"/>
                    </padding>
                    
                    <center>
                        <VBox spacing="10" VBox.vgrow="ALWAYS">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Instruction Pipeline" 
                                       style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <!-- Test case buttons removed; use File > Open Program... -->
                            </HBox>
                            
                            <TableView fx:id="instructionTable" VBox.vgrow="ALWAYS"
                                       style="-fx-background-color: white; -fx-background-radius: 6;">
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                                <columns>
                                    <TableColumn fx:id="colInstrIndex" text="#" prefWidth="50"/>
                                    <TableColumn fx:id="colInstrPC" text="PC" prefWidth="80"/>
                                    <TableColumn fx:id="colInstrText" text="Instruction" prefWidth="250"/>
                                    <TableColumn fx:id="colIssue" text="Issue" prefWidth="80"/>
                                    <TableColumn fx:id="colExecStart" text="Exec Start" prefWidth="100"/>
                                    <TableColumn fx:id="colExecEnd" text="Exec End" prefWidth="100"/>
                                    <TableColumn fx:id="colWriteBack" text="Write Back" prefWidth="100"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </center>
                    
                    <bottom>
                        <VBox fx:id="logContainer" spacing="5" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 10;" VBox.vgrow="NEVER">
                            <VBox.margin>
                                <Insets top="10"/>
                            </VBox.margin>
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Execution Log" style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Button text="Clear Log" onAction="#onClearLog"
                                        style="-fx-background-color: transparent; -fx-text-fill: #666; -fx-font-size: 11;"/>
                            </HBox>
                            <TextArea fx:id="logArea" prefRowCount="5" wrapText="true"
                                      style="-fx-control-inner-background: #fafafa; -fx-border-color: #e0e0e0; -fx-border-radius: 4; -fx-background-radius: 4;"/>
                        </VBox>
                    </bottom>
                </BorderPane>
            </Tab>
            
            <!-- Reservation Stations Tab -->
            <Tab text="ðŸ”§ Reservation Stations">
                <ScrollPane fitToWidth="true" fitToHeight="true" style="-fx-background-color: #f5f5f5;">
                    <VBox spacing="15" style="-fx-background-color: #f5f5f5;">
                        <padding>
                            <Insets top="15" right="15" bottom="15" left="15"/>
                        </padding>
                        
                        <!-- Add/Sub Stations -->
                        <VBox spacing="8" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 15;">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Add/Sub Reservation Stations" 
                                       style="-fx-font-size: 15; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="addSubBusyLabel" text="0 / 3 Busy"
                                       style="-fx-font-size: 12; -fx-text-fill: #666;"/>
                            </HBox>
                            <TableView fx:id="addSubRsTable" prefHeight="150">
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                                <columns>
                                    <TableColumn fx:id="colRsName1" text="Name" prefWidth="80"/>
                                    <TableColumn fx:id="colRsOp1" text="Operation" prefWidth="100"/>
                                    <TableColumn fx:id="colRsVj1" text="Vj" prefWidth="80"/>
                                    <TableColumn fx:id="colRsVk1" text="Vk" prefWidth="80"/>
                                    <TableColumn fx:id="colRsQj1" text="Qj" prefWidth="80"/>
                                    <TableColumn fx:id="colRsQk1" text="Qk" prefWidth="80"/>
                                    <TableColumn fx:id="colRsBusy1" text="Busy" prefWidth="60"/>
                                </columns>
                            </TableView>
                        </VBox>
                        
                        <!-- Mul/Div Stations -->
                        <VBox spacing="8" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 15;">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Mul/Div Reservation Stations" 
                                       style="-fx-font-size: 15; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="mulDivBusyLabel" text="0 / 2 Busy"
                                       style="-fx-font-size: 12; -fx-text-fill: #666;"/>
                            </HBox>
                            <TableView fx:id="mulDivRsTable" prefHeight="120">
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                                <columns>
                                    <TableColumn fx:id="colRsName2" text="Name" prefWidth="80"/>
                                    <TableColumn fx:id="colRsOp2" text="Operation" prefWidth="100"/>
                                    <TableColumn fx:id="colRsVj2" text="Vj" prefWidth="80"/>
                                    <TableColumn fx:id="colRsVk2" text="Vk" prefWidth="80"/>
                                    <TableColumn fx:id="colRsQj2" text="Qj" prefWidth="80"/>
                                    <TableColumn fx:id="colRsQk2" text="Qk" prefWidth="80"/>
                                    <TableColumn fx:id="colRsBusy2" text="Busy" prefWidth="60"/>
                                </columns>
                            </TableView>
                        </VBox>
                        
                        <!-- Memory Buffers Section -->
                        <Label text="Memory Buffers" 
                               style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #333; -fx-padding: 10 0 0 0;"/>
                        
                        <!-- Load Buffer -->
                        <VBox spacing="8" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 15;">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Load Buffer" 
                                       style="-fx-font-size: 15; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="loadBufferBusyLabel" text="0 / 3 Busy"
                                       style="-fx-font-size: 12; -fx-text-fill: #666;"/>
                            </HBox>
                            <TableView fx:id="loadBufferTable" prefHeight="140">
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                                <columns>
                                    <TableColumn fx:id="colLoadName" text="Name" prefWidth="80"/>
                                    <TableColumn fx:id="colLoadOp" text="Operation" prefWidth="100"/>
                                    <TableColumn fx:id="colLoadAddress" text="Address" prefWidth="120"/>
                                    <TableColumn fx:id="colLoadDest" text="Destination" prefWidth="100"/>
                                    <TableColumn fx:id="colLoadBusy" text="Busy" prefWidth="60"/>
                                </columns>
                            </TableView>
                        </VBox>
                        
                        <!-- Store Buffer -->
                        <VBox spacing="8" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 15;">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Store Buffer" 
                                       style="-fx-font-size: 15; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="storeBufferBusyLabel" text="0 / 3 Busy"
                                       style="-fx-font-size: 12; -fx-text-fill: #666;"/>
                            </HBox>
                            <TableView fx:id="storeBufferTable" prefHeight="140">
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                                <columns>
                                    <TableColumn fx:id="colStoreName" text="Name" prefWidth="80"/>
                                    <TableColumn fx:id="colStoreOp" text="Operation" prefWidth="100"/>
                                    <TableColumn fx:id="colStoreAddress" text="Address" prefWidth="120"/>
                                    <TableColumn fx:id="colStoreSrc" text="Source" prefWidth="100"/>
                                    <TableColumn fx:id="colStoreBusy" text="Busy" prefWidth="60"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </VBox>
                </ScrollPane>
            </Tab>
            
            <!-- Registers Tab -->
            <Tab text="ðŸ“Š Registers">
                <ScrollPane fitToWidth="true" fitToHeight="true" style="-fx-background-color: #f5f5f5;">
                    <HBox spacing="15" style="-fx-background-color: #f5f5f5;" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="15" right="15" bottom="15" left="15"/>
                        </padding>
                        
                        <!-- Integer Registers -->
                        <VBox spacing="8" HBox.hgrow="ALWAYS" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 15;">
                            <Label text="Integer Registers (R0-R31)" 
                                   style="-fx-font-size: 15; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                            <TableView fx:id="intRegTable" VBox.vgrow="ALWAYS">
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                                <columns>
                                    <TableColumn fx:id="colIntRegName" text="Register" prefWidth="100"/>
                                    <TableColumn fx:id="colIntRegValue" text="Value" prefWidth="150"/>
                                    <TableColumn fx:id="colIntRegTag" text="Tag (Qi)" prefWidth="150"/>
                                </columns>
                            </TableView>
                        </VBox>
                        
                        <!-- Floating Point Registers -->
                        <VBox spacing="8" HBox.hgrow="ALWAYS" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 15;">
                            <Label text="Floating Point Registers (F0-F30)" 
                                   style="-fx-font-size: 15; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                            <TableView fx:id="fpRegTable" VBox.vgrow="ALWAYS">
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                                <columns>
                                    <TableColumn fx:id="colFpRegName" text="Register" prefWidth="100"/>
                                    <TableColumn fx:id="colFpRegValue" text="Value" prefWidth="150"/>
                                    <TableColumn fx:id="colFpRegTag" text="Tag (Qi)" prefWidth="150"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </HBox>
                </ScrollPane>
            </Tab>
            
            <!-- Memory & Cache Tab -->
            <Tab text="ðŸ’¾ Memory &amp; Cache">
                <ScrollPane fitToWidth="true" fitToHeight="true" style="-fx-background-color: #f5f5f5;">
                    <VBox spacing="15" style="-fx-background-color: #f5f5f5;">
                        <padding>
                            <Insets top="15" right="15" bottom="15" left="15"/>
                        </padding>
                        
                        <!-- Cache Statistics -->
                        <HBox spacing="15">
                            <VBox spacing="8" HBox.hgrow="ALWAYS" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 15;">
                                <Label text="Cache Statistics" 
                                       style="-fx-font-size: 15; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                                <GridPane hgap="20" vgap="10">
                                    <Label text="Cache Hits:" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                           style="-fx-font-size: 13; -fx-text-fill: #666;"/>
                                    <Label fx:id="cacheHitsLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                           style="-fx-font-size: 13; -fx-font-weight: bold; -fx-text-fill: #4CAF50;"/>
                                    
                                    <Label text="Cache Misses:" GridPane.columnIndex="0" GridPane.rowIndex="1"
                                           style="-fx-font-size: 13; -fx-text-fill: #666;"/>
                                    <Label fx:id="cacheMissesLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="1"
                                           style="-fx-font-size: 13; -fx-font-weight: bold; -fx-text-fill: #f44336;"/>
                                    
                                    <Label text="Hit Rate:" GridPane.columnIndex="0" GridPane.rowIndex="2"
                                           style="-fx-font-size: 13; -fx-text-fill: #666;"/>
                                    <Label fx:id="hitRateLabel" text="0.0%" GridPane.columnIndex="1" GridPane.rowIndex="2"
                                           style="-fx-font-size: 13; -fx-font-weight: bold; -fx-text-fill: #2196F3;"/>
                                </GridPane>
                            </VBox>
                            
                            <VBox spacing="8" HBox.hgrow="ALWAYS" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 15;">
                                <Label text="Cache Configuration" 
                                       style="-fx-font-size: 15; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                                <GridPane hgap="20" vgap="10">
                                    <Label text="Block Size:" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                           style="-fx-font-size: 13; -fx-text-fill: #666;"/>
                                    <Label fx:id="blockSizeLabel" text="16 bytes" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                           style="-fx-font-size: 13;"/>
                                    
                                    <Label text="Cache Size:" GridPane.columnIndex="0" GridPane.rowIndex="1"
                                           style="-fx-font-size: 13; -fx-text-fill: #666;"/>
                                    <Label fx:id="cacheSizeLabel" text="64 bytes" GridPane.columnIndex="1" GridPane.rowIndex="1"
                                           style="-fx-font-size: 13;"/>
                                    
                                    <Label text="Hit Latency:" GridPane.columnIndex="0" GridPane.rowIndex="2"
                                           style="-fx-font-size: 13; -fx-text-fill: #666;"/>
                                    <Label fx:id="hitLatencyLabel" text="1 cycle" GridPane.columnIndex="1" GridPane.rowIndex="2"
                                           style="-fx-font-size: 13;"/>
                                    
                                    <Label text="Miss Penalty:" GridPane.columnIndex="0" GridPane.rowIndex="3"
                                           style="-fx-font-size: 13; -fx-text-fill: #666;"/>
                                    <Label fx:id="missPenaltyLabel" text="10 cycles" GridPane.columnIndex="1" GridPane.rowIndex="3"
                                           style="-fx-font-size: 13;"/>
                                </GridPane>
                            </VBox>
                        </HBox>
                        
                        <!-- Data Cache -->
                        <VBox spacing="8" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 15;">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Data Cache Contents" 
                                       style="-fx-font-size: 15; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Button text="Clear Cache" onAction="#onClearCache"
                                        style="-fx-background-color: white; -fx-border-color: #f44336; -fx-text-fill: #f44336; -fx-border-radius: 4; -fx-background-radius: 4; -fx-padding: 4 12;"/>
                            </HBox>
                            <TableView fx:id="cacheTable" prefHeight="400">
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                                <columns>
                                    <TableColumn fx:id="colCacheIndex" text="Index" prefWidth="80"/>
                                    <TableColumn fx:id="colCacheValid" text="Valid" prefWidth="80"/>
                                    <TableColumn fx:id="colCacheTag" text="Tag" prefWidth="120"/>
                                    <TableColumn fx:id="colCacheData" text="Data (Hex)" prefWidth="400"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </VBox>
                </ScrollPane>
            </Tab>
            
            <!-- Configuration Tab -->
            <Tab text="âš™ Configuration">
                <ScrollPane fitToWidth="true" fitToHeight="true" style="-fx-background-color: #f5f5f5;">
                    <VBox spacing="20" style="-fx-background-color: #f5f5f5;">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        
                        <!-- Instruction Latencies -->
                        <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 20;">
                            <Label text="Instruction Latencies (Cycles)" 
                                   style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                            <Separator/>
                            <GridPane hgap="30" vgap="15">
                                <Label text="FP Add/Sub:" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="addLatencyField" text="2" prefWidth="100"
                                           GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                                
                                <Label text="FP Multiply:" GridPane.columnIndex="2" GridPane.rowIndex="0"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="mulLatencyField" text="10" prefWidth="100"
                                           GridPane.columnIndex="3" GridPane.rowIndex="0"/>
                                
                                <Label text="FP Divide:" GridPane.columnIndex="0" GridPane.rowIndex="1"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="divLatencyField" text="40" prefWidth="100"
                                           GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                                
                                <Label text="Integer Add/Sub:" GridPane.columnIndex="2" GridPane.rowIndex="1"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="intAddLatencyField" text="1" prefWidth="100"
                                           GridPane.columnIndex="3" GridPane.rowIndex="1"/>
                                
                                <Label text="Load (on hit):" GridPane.columnIndex="0" GridPane.rowIndex="2"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="loadLatencyField" text="2" prefWidth="100"
                                           GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                                
                                <Label text="Store (on hit):" GridPane.columnIndex="2" GridPane.rowIndex="2"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="storeLatencyField" text="2" prefWidth="100"
                                           GridPane.columnIndex="3" GridPane.rowIndex="2"/>
                                
                                <Label text="Branch:" GridPane.columnIndex="0" GridPane.rowIndex="3"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="branchLatencyField" text="1" prefWidth="100"
                                           GridPane.columnIndex="1" GridPane.rowIndex="3"/>
                            </GridPane>
                        </VBox>
                        
                        <!-- Station/Buffer Sizes -->
                        <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 20;">
                            <Label text="Reservation Station &amp; Buffer Sizes" 
                                   style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                            <Separator/>
                            <GridPane hgap="30" vgap="15">
                                <Label text="Add/Sub Stations:" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="addSubSizeField" text="3" prefWidth="100"
                                           GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                                
                                <Label text="Mul/Div Stations:" GridPane.columnIndex="2" GridPane.rowIndex="0"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="mulDivSizeField" text="2" prefWidth="100"
                                           GridPane.columnIndex="3" GridPane.rowIndex="0"/>
                                
                                <Label text="Load Buffer Size:" GridPane.columnIndex="0" GridPane.rowIndex="1"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="loadBufferSizeField" text="3" prefWidth="100"
                                           GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                                
                                <Label text="Store Buffer Size:" GridPane.columnIndex="2" GridPane.rowIndex="1"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="storeBufferSizeField" text="3" prefWidth="100"
                                           GridPane.columnIndex="3" GridPane.rowIndex="1"/>
                            </GridPane>
                        </VBox>
                        
                        <!-- Cache Configuration -->
                        <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 20;">
                            <Label text="Cache Configuration" 
                                   style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                            <Separator/>
                            <GridPane hgap="30" vgap="15">
                                <Label text="Cache Size (bytes):" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="cacheSizeField" text="64" prefWidth="100"
                                           GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                                
                                <Label text="Block Size (bytes):" GridPane.columnIndex="2" GridPane.rowIndex="0"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="blockSizeField" text="16" prefWidth="100"
                                           GridPane.columnIndex="3" GridPane.rowIndex="0"/>
                                
                                <Label text="Hit Latency (cycles):" GridPane.columnIndex="0" GridPane.rowIndex="1"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="cacheHitLatencyField" text="1" prefWidth="100"
                                           GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                                
                                <Label text="Miss Penalty (cycles):" GridPane.columnIndex="2" GridPane.rowIndex="1"
                                       style="-fx-font-size: 13;"/>
                                <TextField fx:id="cacheMissPenaltyField" text="10" prefWidth="100"
                                           GridPane.columnIndex="3" GridPane.rowIndex="1"/>
                            </GridPane>
                        </VBox>
                        
                        <!-- Register Initialization -->
                        <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 20;">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Register Initialization" 
                                       style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Button text="Load from File" onAction="#onLoadRegisterValues"
                                        style="-fx-background-color: #2196F3; -fx-text-fill: white; -fx-border-radius: 4; -fx-background-radius: 4; -fx-padding: 6 16;"/>
                                <Button text="Reset to Zero" onAction="#onResetRegisters"
                                        style="-fx-background-color: white; -fx-border-color: #ddd; -fx-border-radius: 4; -fx-background-radius: 4; -fx-padding: 6 16;"/>
                            </HBox>
                            <Separator/>
                            <TextArea fx:id="registerInitArea" promptText="Enter register initializations (e.g., R1=100, F2=3.14)..."
                                      prefRowCount="4" wrapText="true"
                                      style="-fx-control-inner-background: #fafafa; -fx-border-color: #e0e0e0; -fx-border-radius: 4; -fx-background-radius: 4;"/>
                        </VBox>
                        
                        <!-- Memory Initialization -->
                        <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 20;">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Memory Initialization" 
                                       style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                            </HBox>
                            <Separator/>
                            <TextArea fx:id="memoryInitArea" promptText="Enter memory initializations (e.g., 0x100=42, [256]=0xFF)..."
                                      prefRowCount="4" wrapText="true"
                                      style="-fx-control-inner-background: #fafafa; -fx-border-color: #e0e0e0; -fx-border-radius: 4; -fx-background-radius: 4;"/>
                        </VBox>
                        <!-- Apply Configuration Button -->
                        <HBox spacing="10" alignment="CENTER">
                            <Button text="Apply Configuration" onAction="#onApplyConfig"
                                    style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-font-size: 14; -fx-font-weight: bold; -fx-padding: 10 30; -fx-background-radius: 4;"/>
                            <Button text="Reset to Defaults" onAction="#onResetConfig"
                                    style="-fx-background-color: white; -fx-border-color: #ddd; -fx-font-size: 14; -fx-padding: 10 30; -fx-border-radius: 4; -fx-background-radius: 4;"/>
                        </HBox>
                    </VBox>
                </ScrollPane>
            </Tab>
            
            <!-- Statistics Tab -->
            <Tab text="ðŸ“ˆ Statistics">
                <ScrollPane fitToWidth="true" fitToHeight="true" style="-fx-background-color: #f5f5f5;">
                    <VBox spacing="20" style="-fx-background-color: #f5f5f5;">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        
                        <!-- Performance Metrics -->
                        <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 20;">
                            <Label text="Performance Metrics" 
                                   style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                            <Separator/>
                            <GridPane hgap="40" vgap="15">
                                <Label text="Total Cycles:" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="totalCyclesLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                       style="-fx-font-size: 14; -fx-font-weight: bold;"/>
                                
                                <Label text="Instructions Completed:" GridPane.columnIndex="0" GridPane.rowIndex="1"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="completedInstrLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="1"
                                       style="-fx-font-size: 14; -fx-font-weight: bold;"/>
                                
                                <Label text="IPC (Instructions per Cycle):" GridPane.columnIndex="0" GridPane.rowIndex="2"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="ipcLabel" text="0.00" GridPane.columnIndex="1" GridPane.rowIndex="2"
                                       style="-fx-font-size: 14; -fx-font-weight: bold;"/>
                                
                                <Label text="Average CPI:" GridPane.columnIndex="0" GridPane.rowIndex="3"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="cpiLabel" text="0.00" GridPane.columnIndex="1" GridPane.rowIndex="3"
                                       style="-fx-font-size: 14; -fx-font-weight: bold;"/>
                            </GridPane>
                        </VBox>
                        
                        <!-- Hazard Statistics -->
                        <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 20;">
                            <Label text="Hazard Statistics" 
                                   style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                            <Separator/>
                            <GridPane hgap="40" vgap="15">
                                <Label text="RAW Hazards Detected:" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="rawHazardsLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                       style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #FF9800;"/>
                                
                                <Label text="WAR Hazards Detected:" GridPane.columnIndex="0" GridPane.rowIndex="1"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="warHazardsLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="1"
                                       style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #FF9800;"/>
                                
                                <Label text="WAW Hazards Detected:" GridPane.columnIndex="0" GridPane.rowIndex="2"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="wawHazardsLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="2"
                                       style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #FF9800;"/>
                                
                                <Label text="Structural Hazards:" GridPane.columnIndex="0" GridPane.rowIndex="3"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="structuralHazardsLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="3"
                                       style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #FF9800;"/>
                            </GridPane>
                        </VBox>
                        
                        <!-- Instruction Mix -->
                        <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 6; -fx-padding: 20;">
                            <Label text="Instruction Mix" 
                                   style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #333;"/>
                            <Separator/>
                            <GridPane hgap="40" vgap="15">
                                <Label text="Load Instructions:" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="loadCountLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                       style="-fx-font-size: 14; -fx-font-weight: bold;"/>
                                
                                <Label text="Store Instructions:" GridPane.columnIndex="0" GridPane.rowIndex="1"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="storeCountLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="1"
                                       style="-fx-font-size: 14; -fx-font-weight: bold;"/>
                                
                                <Label text="ALU Operations:" GridPane.columnIndex="0" GridPane.rowIndex="2"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="aluCountLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="2"
                                       style="-fx-font-size: 14; -fx-font-weight: bold;"/>
                                
                                <Label text="Branch Instructions:" GridPane.columnIndex="0" GridPane.rowIndex="3"
                                       style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                                <Label fx:id="branchCountLabel" text="0" GridPane.columnIndex="1" GridPane.rowIndex="3"
                                       style="-fx-font-size: 14; -fx-font-weight: bold;"/>
                            </GridPane>
                        </VBox>
                        
                        <!-- Export Button -->
                        <HBox spacing="10" alignment="CENTER">
                            <Button text="Export Statistics to File" onAction="#onExportStats"
                                    style="-fx-background-color: #2196F3; -fx-text-fill: white; -fx-font-size: 14; -fx-font-weight: bold; -fx-padding: 10 30; -fx-background-radius: 4;"/>
                        </HBox>
                    </VBox>
                </ScrollPane>
            </Tab>
        </TabPane>
    </center>
    
    <!-- Status bar at bottom -->
    <bottom>
        <HBox spacing="15" alignment="CENTER_LEFT" 
              style="-fx-background-color: white; -fx-padding: 8 15; -fx-border-color: #e0e0e0; -fx-border-width: 1 0 0 0;">
            <Label fx:id="statusBarLabel" text="Ready to simulate" 
                   style="-fx-font-size: 12; -fx-text-fill: #666;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label text="Tomasulo Algorithm Simulator v1.0" 
                   style="-fx-font-size: 11; -fx-text-fill: #999;"/>
        </HBox>
    </bottom>
</BorderPane>
